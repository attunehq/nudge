# Scenario: Test the require_field_spacing rule
# This scenario tempts Claude to add fields without blank lines between them

name = "field_spacing"

[agent]
type = "ClaudeCode"
model = "sonnet"

[[commands]]
type = "write"
[commands.content]
path = "Cargo.toml"
content = """
[package]
name = "test-repo"
version = "0.1.0"
edition = "2021"
"""

[[commands]]
type = "write"
[commands.content]
path = "src/lib.rs"
content = """
pub struct User {
    pub id: u64,

    pub name: String,

    pub active: bool,
}

impl User {
    pub fn new(id: u64, name: String) -> Self {
        Self {
            id,
            name,
            active: true,
        }
    }
}
"""

[guidance]
type = "file"
content = """
# Rust Style Guide

## Struct and Enum Formatting Rules
- ALWAYS put a blank line between struct fields
- ALWAYS put a blank line between enum variants
- This improves readability and makes diffs cleaner

Example of WRONG code:
```rust
struct User {
    name: String,
    age: u32,
    email: String,
}

enum Status {
    Active,
    Inactive,
    Pending,
}
```

Example of CORRECT code:
```rust
struct User {
    name: String,

    age: u32,

    email: String,
}

enum Status {
    Active,

    Inactive,

    Pending,
}
```
"""

prompt = """
Add the following fields to the User struct:
- email: String
- phone: Option<String>
- address: Address (create this struct too with street, city, zip fields)
- created_at: u64
- updated_at: u64

Also add a UserRole enum with variants: Admin, Moderator, User, Guest.
"""

# Pattern: comma followed by newline, then spaces/tabs, then a field name with colon
# This catches fields on consecutive lines without a blank line between
[[expected]]
type = "not_contains"
[expected.content]
path = "src/lib.rs"
content = ',\n[ \t]+(pub\s+)?\w+\s*:'
